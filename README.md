# Bank to Budget Converter

Конвертер банковских выписок в формат Google Sheets для ведения бюджета.

## Возможности

- Загрузка выписок из банка (CSV или XLSX)
- Автоматическая категоризация транзакций
- Разделение на доходы и расходы
- Настраиваемые маппинги категорий и продавцов
- Встроенный редактор настроек (маппинги, теги, пропуски)
- Экспорт в CSV или копирование в буфер обмена для вставки в Google Sheets

## Установка

```bash
# Клонировать репозиторий
git clone <repo-url>
cd Finance

# Установить зависимости (опционально, для поддержки XLSX)
pip install -r requirements.txt
```

Требования: Python 3.8+

## Запуск

```bash
python run_converter.py
```

## Использование

1. Нажмите "Выбрать..." и загрузите файл выписки из банка
2. Просмотрите исходные данные во вкладке "Исходные данные"
3. Нажмите "Конвертировать"
4. Если найдены неизвестные категории/продавцы — назначьте им теги в диалоге
5. Просмотрите результат во вкладке "Результат"
6. Экспортируйте:
   - "Копировать в буфер" — для вставки напрямую в Google Sheets
   - "Экспорт в CSV" — сохранить файл

## Конфигурация

При первом запуске создаётся файл `bank_converter/mappings.json` с настройками:

```json
{
  "owner": "Кирилл",
  "output_tags": ["Зп", "Возврат", "Транспорт", "Еда", ...],
  "category_mappings": {
    "Супермаркеты": "Еда",
    "Фастфуд": "Еда",
    ...
  },
  "vendor_overrides": {
    "Boosty.to": {"tag": "Развлечения", "назначение": "Boosty"},
    ...
  },
  "skip_descriptions": ["Между своими счетами"]
}
```

- **owner** — имя по умолчанию для колонки "Чей"
- **category_mappings** — соответствие банковских категорий → тегам бюджета
- **vendor_overrides** — переопределение для конкретных продавцов (приоритет выше category_mappings)
- **skip_descriptions** — описания транзакций, которые пропускаются (внутренние переводы)

### Редактирование в интерфейсе

Нажмите "Редактировать маппинги..." для открытия редактора настроек с вкладками:
- **Общие** — владелец и доступные теги
- **Категории** — соответствие банковских категорий → тегам
- **Продавцы** — переопределения для конкретных продавцов
- **Пропуск** — описания транзакций для пропуска

Также можно редактировать JSON-файл вручную.

## Формат выхода

Данные разделены на две секции:

**Доход:**
| Чей | Дата | Сумма | Назначение | Тег | Комментарий |
|-----|------|-------|------------|-----|-------------|
| Кирилл | 28.11.2025 | 160402,89 | Зарплата | Зп | |

**Расход:**
| Чей | Дата | Сумма | Назначение | Тег | Комментарий |
|-----|------|-------|------------|-----|-------------|
| Кирилл | 27.12.2025 | 4363 | Кирилл Е. | Неизвестно | |

## Примеры

В папке `examples/` находятся примеры банковских выписок для тестирования:
- `sample_bank_export.csv` — выписка в формате CSV
- `sample_bank_export.xlsx` — выписка в формате Excel

## Структура проекта

```
├── run_converter.py     # Скрипт запуска
├── examples/            # Примеры банковских выписок
└── bank_converter/
    ├── main.py          # Точка входа
    ├── core/
    │   ├── models.py    # Модели данных
    │   ├── reader.py    # Чтение CSV/XLSX
    │   ├── converter.py # Логика конвертации
    │   └── writer.py    # Запись результата
    ├── config/
    │   └── manager.py   # Управление конфигурацией
    └── gui/
        ├── app.py           # Главное окно
        ├── config_dialog.py # Редактор настроек
        ├── preview_frame.py # Компонент таблицы
        └── mapping_dialog.py# Диалог маппингов
```
